schema: '2.0'
stages:
  prepare:
    cmd: python -m src.prepare --config=params.yaml
    deps:
    - path: src/prepare.py
      md5: d0199bd4f994ce8b2783c70993fb7e6d
      size: 995
    params:
      params.yaml:
        base:
          random_state: 42
        prepare:
          test_size: 0.2
          trainset_path: data/trainset.csv
          testset_path: data/testset.csv
    outs:
    - path: data/testset.csv
      md5: 9837a9d5136087f500dd3f43ed4c97d7
      size: 401141
    - path: data/trainset.csv
      md5: 0bca98cbda08b5d98f5ea2c3484c5ea6
      size: 1606831
  train:
    cmd: python -m src.train --config=params.yaml
    deps:
    - path: data/trainset.csv
      md5: 0bca98cbda08b5d98f5ea2c3484c5ea6
      size: 1606831
    - path: src/train.py
      md5: 7c8b33791903b87dca3cc0e8e723b090
      size: 1879
    params:
      params.yaml:
        base:
          random_state: 42
        prepare.trainset_path: data/trainset.csv
        train:
          alpha:
          - 0.001
          - 0.1
          - 1
          - 10
          - 100
          l1_ratio:
          - 0
          - 0.1
          - 0.5
          - 0.9
          - 1
          kfold_n_splits: 5
          scoring_function: r2
          model_path: models/model.pkl
          hpo_metrics_path: reports/hpo-metrics.json
    outs:
    - path: models/model.pkl
      md5: d00764067f824ff48599cb1e2f73c002
      size: 6907
    - path: reports/hpo-metrics.json
      md5: 1cf8f80e85cc567c5c621d63bfd01873
      size: 7131
  evaluate:
    cmd: python -m src.evaluate --config=params.yaml
    deps:
    - path: data/testset.csv
      md5: 9837a9d5136087f500dd3f43ed4c97d7
      size: 401141
    - path: models/model.pkl
      md5: d00764067f824ff48599cb1e2f73c002
      size: 6907
    - path: src/evaluate.py
      md5: 88d2b8f031550a975d85de7a85a33826
      size: 1328
    params:
      params.yaml:
        evaluate:
          metrics_path: reports/metrics.json
        prepare.testset_path: data/testset.csv
        train.model_path: models/model.pkl
    outs:
    - path: reports/metrics.json
      md5: d13f7242b416590e65e725e1f0dcdb79
      size: 85
